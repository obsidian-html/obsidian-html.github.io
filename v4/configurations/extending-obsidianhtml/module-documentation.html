<!DOCTYPE html>

<html lang="en">

        <head>
                <!-- Page information -->
                <meta charset="UTF-8" />
                <meta name="node_id" content="module documentation">
                <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                <link rel="shortcut icon" href="/v4/favicon.ico" />

                <!-- Set title -->
                <title>ObsidianHtml/Documentation</title>

                <!-- Includes -->
                
<script src="/v4/obs.html/static/obsidian_core.js"></script>
<script src="/v4/obs.html/static/encoding.js"></script>
<link rel="stylesheet" href="/v4/obs.html/static/master.css" />
<script src="/v4/obs.html/static/mermaid.9.0.1.min.js"></script>
<script>
  MathJax = {
    loader: {
      load: [
        '[tex]/action',
        'output/chtml',
        '[tex]/centernot'
      ]
    },
    tex: {
      inlineMath: [ ["\\(","\\)"] ],
      displayMath: [ ["\\[","\\]"] ],
      processEscapes: true,
      processEnvironments: true,
      packages: {'[+]': ['centernot']}
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
<script src="/v4/obs.html/static/flexsearch.bundle.js"></script>
<script src="/v4/obs.html/static/pako.js"></script>
<script src="/v4/obs.html/static/search.js"></script>
<script src="/v4/obs.html/static/dirtree.js"></script>


                <!-- Onload tweaks -->
                <script>
                        const CURRENT_NODE = 'module documentation';
                        const HTML_URL_PREFIX = '/v4';
                        const PAGE_DEPTH = 2;
                </script>
        </head>

<body class="theme-obs-light">
        <div id="antiflash" style="display: none;"></div>
        <script>
                document.getElementById('antiflash').style.display = 'block';
        </script>
        <div id="search-master-div">
    <div id="search-slab" king_ramses="return the slaaab">
            <div id="search-controls">
                    <input id="search_string" placeholder="Type to search notes" type="text" />
                    <div class="tooltip" style="display: none;">
                        <input type="checkbox" id="hard_search" name="hard" />
                        <span class="tooltiptext">Hard search (require exact match)</span>
                    </div>
                    <div id="search-results-box">
                        <div id="search-results"></div>
                    </div>
                    <div id="search-instructions">
                        <div class="prompt-instruction">
                                <b>esc</b> to dismiss
                        </div>
                    </div>
            </div>
    </div>
</div>

<script>
    document.getElementById("search-master-div").addEventListener('click', e => {
            if(e.target !== e.currentTarget){
                    return
            }
            toggle_id('search-master-div');
    })
    document.getElementById("search_string").addEventListener("input", function(event) {
            setTimeout( () =>run_search('search_string', 'hard_search'), 100 );
    }); 
    document.getElementById("hard_search").addEventListener("click", function(event) {
            setTimeout( () =>run_search('search_string', 'hard_search'), 100 );
    });

    window.addEventListener('keydown', e => {
        if((e.key=='Escape'||e.key=='Esc'||e.keyCode==27)){
            toggle_id('search-master-div');
            return false;
        } 
    }, true);

    function click_list_link(element){
        element.parentElement.getElementsByTagName('a')[0].click()
    }
</script>

        <div id="page_holder" class="flex_col">
                <div id="header" class="header">
    <div id="header_flex" class="flex_row">
            <a href="/v4/index.html" id="homelink" title="Clear screen and go to homepage">ObsidianHtml/Documentation</a>
            <div id="menu_toggle_button" class="navbar-button requires_js" onclick="toggle_menu()">
                    â‰¡
            </div>
            <div id="navbar" class="navbar requires_js">
                    <a class="navbar-link" href="/v4/index.html" title="Home">Home</a>
<a class="navbar-link" href="/v4/general-information/about-obsidianhtml.html" title="About">About</a>
<a class="navbar-link" href="/v4/instructions/quickstart.html" title="Quickstart">Quickstart</a>
<a class="navbar-link" href="/v4/configurations/features/features.html" title="Features">Features</a>
<a class="navbar-link" href="/v4/configurations/configuration-options.html" title="Configurations">Configurations</a>
<a class="navbar-link" href="/v4/configurations/styling/styling.html" title="Styling">Styling</a>
<a class="navbar-link" href="/v4/configurations/modes/modes.html" title="Modes">Modes</a>
<a class="navbar-link" href="/v4/news.html" title="News">News</a>
                    <div class="icon-tray">
                            <div id="theme-button" class="theme-button requires_js" title="Change theme" onclick="toggle_theme_popup(this)">
    T
</div>
<script>
    function toggle_theme_popup(el){
        // make theme button show that it's active by adding the .active class
        toggle(el);

        // show the theme selector
        toggle_id('theme-popup')

        let h2 = document.getElementById('header2')
        if (h2){
            let pu = document.getElementById('header2').getElementsByClassName('popup')[0];
            toggle(pu);
        }
    }

    function disable_theme_popup(){
        disable_id('theme-button');

        // show the theme selector
        disable_id('theme-popup')

        let h2 = document.getElementById('header2')
        if (h2){
            let pu = document.getElementById('header2').getElementsByClassName('popup')[0];
            disable(pu);
        }
    }
</script>
                                    <div onclick="openSearch()" class="theme-button requires_js">
            <img src = "/v4/obs.html/static/search.svg" alt="Search notes" title="Search notes" style="margin: 4px;"/>
        </div>
        <script>
            function openSearch(){
                // toggle search popup and continue with extra code if it is enabled this time
                if (toggle_id('search-master-div')){
                    // get input field and temporarily disable it
                    let ss = document.getElementById('search_string');
                    ss.value = 'Seach data initializing...';
                    ss.readOnly = true; 

                    // load search data if not yet done so
                    setTimeout(function(){
                        LoadSearchData()

                        // clear input and put focus on it so that we can start typing immediately
                        ss.value = '';
                        ss.readOnly = false; 
                        ss.focus()
                        ss.select()
                    }, 100);
                }
            }
        </script>
                                    <div class="graph_header_div requires_js">
            <a id="graph_link" class="system-link" href="/v4/obs.html/graph/index.html?node=module documentation" title="Open fullpage Graph">
                    <img class="graph_header_div_svg" src = "/v4/obs.html/static/graph.svg" alt="Open fullpage Graph" style="margin: 2px; width: 17px;"/>
            </a>
        </div>
                                    <div >
            <a id="dirtree_link" class="system-link" href="/v4/dirtree.html" title="View directory tree">
                    <img src = "/v4/obs.html/static/dirtree.svg" style="width: 12px; padding: 4px;" alt="Directory tree link"/>
            </a>
        </div>
                            <div>
    <a href="/v4/obs.html/tags/index.html" title="Open tag view">
            <img src = "/v4/obs.html/static/hashtag.svg" alt="RSS Feed link" style="width: 24px; margin-left: -2px; margin-top: -2px;"/>
    </a>
</div>
                                    <div>
            <a id="rss_link" class="system-link" href="/v4/obs.html/rss/feed.xml" title="RSS Feed link">
                    <img src = "/v4/obs.html/static/rss.svg" alt="RSS Feed link"/>
            </a>
        </div>
                    </div>
                    <div style="display: flex; flex-direction:column">
                        <div id="left_pane_toggle_nav" class="left_pane_toggle_nav">Toggle Directory Tree Pane</div>
                        <div id="right_pane_toggle_nav" class="right_pane_toggle_nav">Toggle Table of Contents Pane</div>
                    </div>
            </div>
    </div>
    <div class="popup" id="theme-popup">
    <label for="cars">Theme </label>

    <select name="theme" id="theme" onchange="set_theme(this.value)">
      <option value="light">light</option>
      <option value="obs-light" selected="selected">obsidian-light</option>
      <option value="obs-dark">obsidian-dark</option>
    </select> 
</div>
</div>
                <div class="flex_row">
                        <div id="left_pane" class="left_pane active">
    <div id="left_pane_fold_header" class="left_pane_fold_header fold_header">x</div>
    <div id="left_pane_content" class="left_pane_content">
            <div class="dirtree"><button id="folder-1" class="dir-button" onclick="toggle_dir(this.id)">automation</button>
<div id="folder-container-1" class="dir-container requires_js " path="/v4/automation">
	<ul class="dir-list">
		<li><a class="" href="/v4/automation/automate-website-deployment.html"  >Automate website deployment</a></li>
		<li><a class="" href="/v4/automation/automationlinuxgit.html"  >Auto push site using Git on Linux</a></li>
		<li><a class="" href="/v4/automation/automationlinuxssh.html"  >Auto push site using SSH on Linux</a></li>
		<li><a class="" href="/v4/automation/automationwindows.html"  >Auto push site using Git on Windows</a></li>
		<li><a class="" href="/v4/automation/automationwindowsssh.html"  >Auto push site using Git on Windows</a></li>
	</ul>
</div>
<button id="folder-2" class="dir-button folder_note " href="/v4/changelog/changelog.html" onclick="open_folder_note(this)"><div class="fn_pf"></div>changelog</button>
<div id="folder-container-2" class="dir-container requires_js " path="/v4/changelog">
	<ul class="dir-list">
		<li><a class="" href="/v4/changelog/v4.0.0.html"  >v4.0.0</a></li>
	</ul>
</div>
<button id="folder-3" class="dir-button" onclick="toggle_dir(this.id)">configurations</button>
<div id="folder-container-3" class="dir-container requires_js active" path="/v4/configurations">
	<button id="folder-4" class="dir-button folder_note " href="/v4/configurations/deprecated-configurations/deprecated-configurations.html" onclick="open_folder_note(this)"><div class="fn_pf"></div>deprecated-configurations</button>
	<div id="folder-container-4" class="dir-container requires_js " path="/v4/configurations/deprecated-configurations">
		<ul class="dir-list">
			<li><a class="" href="/v4/configurations/deprecated-configurations/exclude_subfolders.html"  >exclude_subfolders</a></li>
			<li><a class="" href="/v4/configurations/deprecated-configurations/notabs-mode.html"  >NoTabs Mode</a></li>
			<li><a class="" href="/v4/configurations/deprecated-configurations/obsidian_folder_path_str.html"  >obsidian_folder_path_str</a></li>
		</ul>
	</div>
	<button id="folder-5" class="dir-button" onclick="toggle_dir(this.id)">extending-obsidianhtml</button>
	<div id="folder-container-5" class="dir-container requires_js active" path="/v4/configurations/extending-obsidianhtml">
		<ul class="dir-list">
			<li><a class="active" href="/v4/configurations/extending-obsidianhtml/module-documentation.html"  >Module Documentation</a></li>
		</ul>
	</div>
	<button id="folder-6" class="dir-button folder_note " href="/v4/configurations/features/features.html" onclick="open_folder_note(this)"><div class="fn_pf"></div>features</button>
	<div id="folder-container-6" class="dir-container requires_js " path="/v4/configurations/features">
		<ul class="dir-list">
			<li><a class="" href="/v4/configurations/features/backlinks.html"  >Backlinks</a></li>
			<li><a class="" href="/v4/configurations/features/breadcrumbs.html"  >Breadcrumbs</a></li>
			<li><a class="" href="/v4/configurations/features/embedded-note-title.html"  >Embedded note title</a></li>
			<li><a class="" href="/v4/configurations/features/folder-notes.html"  >Folder Notes</a></li>
			<li><a class="" href="/v4/configurations/features/graph-view.html"  >Graph View</a></li>
			<li><a class="" href="/v4/configurations/features/include-notes.html"  >Include notes</a></li>
			<li><a class="" href="/v4/configurations/features/markdown-post-processing.html"  >Markdown post processing</a></li>
			<li><a class="" href="/v4/configurations/features/rss-feed.html"  >RSS Feed</a></li>
			<li><a class="" href="/v4/configurations/features/side-panes.html"  >Side panes</a></li>
			<li><a class="" href="/v4/configurations/features/slugify-html-links.html"  >Slugify html links</a></li>
			<li><a class="" href="/v4/configurations/features/tags-page.html"  >Tags Page</a></li>
			<li><a class="" href="/v4/configurations/features/website-navigation-menu.html"  >Website navigation menu</a></li>
		</ul>
	</div>
	<button id="folder-7" class="dir-button folder_note " href="/v4/configurations/modes/modes.html" onclick="open_folder_note(this)"><div class="fn_pf"></div>modes</button>
	<div id="folder-container-7" class="dir-container requires_js " path="/v4/configurations/modes">
		<ul class="dir-list">
			<li><a class="" href="/v4/configurations/modes/copy-vault-to-temp-dir.html"  >Copy vault to temp dir</a></li>
			<li><a class="" href="/v4/configurations/modes/create-index-from-directory-structure.html"  >Create Index from Directory Structure</a></li>
			<li><a class="" href="/v4/configurations/modes/create-index-from-tags.html"  >Create index from tags</a></li>
			<li><a class="" href="/v4/configurations/modes/filtering-notes.html"  >Filtering notes</a></li>
			<li><a class="" href="/v4/configurations/modes/process-all.html"  >Process All</a></li>
			<li><a class="" href="/v4/configurations/modes/relative_path_html.html"  >Relative_path_html</a></li>
		</ul>
	</div>
	<button id="folder-8" class="dir-button folder_note " href="/v4/configurations/note-settings/note-settings.html" onclick="open_folder_note(this)"><div class="fn_pf"></div>note-settings</button>
	<div id="folder-container-8" class="dir-container requires_js " path="/v4/configurations/note-settings">
		<ul class="dir-list">
		</ul>
	</div>
	<button id="folder-9" class="dir-button folder_note " href="/v4/configurations/styling/styling.html" onclick="open_folder_note(this)"><div class="fn_pf"></div>styling</button>
	<div id="folder-container-9" class="dir-container requires_js " path="/v4/configurations/styling">
		<ul class="dir-list">
			<li><a class="" href="/v4/configurations/styling/edit-html-css-js.html"  >Edit HTML, CSS, JS</a></li>
			<li><a class="" href="/v4/configurations/styling/tabs-layout.html"  >Tabs Layout</a></li>
			<li><a class="" href="/v4/configurations/styling/writing-a-custom-graph-view-template.html"  >Writing a custom graph view template</a></li>
		</ul>
	</div>
	<button id="folder-10" class="dir-button" onclick="toggle_dir(this.id)">tweaking</button>
	<div id="folder-container-10" class="dir-container requires_js " path="/v4/configurations/tweaking">
		<ul class="dir-list">
			<li><a class="" href="/v4/configurations/tweaking/export-vault-files-to-html-output.html"  >Export vault files to html output</a></li>
			<li><a class="" href="/v4/configurations/tweaking/performance-tuning.html"  >Performance Tuning</a></li>
		</ul>
	</div>
	<ul class="dir-list">
		<li><a class="" href="/v4/configurations/configuration-options.html"  >Configuration Options</a></li>
	</ul>
</div>
<button id="folder-11" class="dir-button folder_note " href="/v4/demonstrations/demonstrations.html" onclick="open_folder_note(this)"><div class="fn_pf"></div>demonstrations</button>
<div id="folder-container-11" class="dir-container requires_js " path="/v4/demonstrations">
	<button id="folder-12" class="dir-button" onclick="toggle_dir(this.id)">test-pages</button>
	<div id="folder-container-12" class="dir-container requires_js " path="/v4/demonstrations/test-pages">
		<ul class="dir-list">
			<li><a class="" href="/v4/demonstrations/test-pages/long-long-page.html"  >Long long page</a></li>
			<li><a class="" href="/v4/demonstrations/test-pages/proper-markdown.html"  >proper markdown</a></li>
			<li><a class="" href="/v4/demonstrations/test-pages/simple-obsidian-type-link.html"  >Simple Obsidian-type Link</a></li>
			<li><a class="" href="/v4/demonstrations/test-pages/test-inclusion.html"  >Test Inclusion</a></li>
			<li><a class="" href="/v4/demonstrations/test-pages/test-inclusion-2.html"  >Test inclusion 2</a></li>
			<li><a class="" href="/v4/demonstrations/test-pages/textfile.txt"  class="external-link">textfile</a></li>
		</ul>
	</div>
	<ul class="dir-list">
		<li><a class="" href="/v4/demonstrations/embedded-search.html"  >Embedded search</a></li>
		<li><a class="" href="/v4/demonstrations/getting-the-basics-right.html"  >Basics</a></li>
		<li><a class="" href="/v4/demonstrations/implementing-call-outs.html"  >Implementing Call-outs</a></li>
		<li><a class="" href="/v4/demonstrations/implementing-dataview.html"  >Implementing Dataview</a></li>
		<li><a class="" href="/v4/demonstrations/implementing-footnotes.html"  >Implementing Footnotes</a></li>
		<li><a class="" href="/v4/demonstrations/implementing-inline-tags.html"  >Implementing inline tags</a></li>
		<li><a class="" href="/v4/demonstrations/implementing-latex.html"  >Implementing Latex</a></li>
		<li><a class="" href="/v4/demonstrations/implementing-links-link-awareness.html"  >Links</a></li>
		<li><a class="" href="/v4/demonstrations/implementing-mermaid-diagrams-in-html-output.html"  >Mermaid Diagrams</a></li>
		<li><a class="" href="/v4/demonstrations/implementing-note-inclusions.html"  >Inclusions</a></li>
		<li><a class="" href="/v4/demonstrations/making-code-blocks-look-pretty.html"  >Code blocks</a></li>
		<li><a class="" href="/v4/demonstrations/making-lists-work-the-same.html"  >Links</a></li>
		<li><a class="" href="/v4/demonstrations/parsing-images-videos-and-audio.html"  >Parsing Images, videos, and audio</a></li>
		<li><a class="" href="/v4/demonstrations/removing-obisidian-comments.html"  >Removing obisidian comments</a></li>
		<li><a class="" href="/v4/demonstrations/sites-using-obsidianhtml.html"  >Sites using ObsidianHtml</a></li>
	</ul>
</div>
<button id="folder-13" class="dir-button" onclick="toggle_dir(this.id)">developer-documentation</button>
<div id="folder-container-13" class="dir-container requires_js " path="/v4/developer-documentation">
	<ul class="dir-list">
		<li><a class="" href="/v4/developer-documentation/contributing-to-obsidianhtml.html"  >Contributing to Obsidianhtml</a></li>
	</ul>
</div>
<button id="folder-14" class="dir-button" onclick="toggle_dir(this.id)">general-information</button>
<div id="folder-container-14" class="dir-container requires_js " path="/v4/general-information">
	<ul class="dir-list">
		<li><a class="" href="/v4/general-information/about-obsidianhtml.html"  >About ObsidianHtml</a></li>
		<li><a class="" href="/v4/general-information/creating-a-static-html-website-from-markdown-files.html"  >Creating a static html website from markdown files</a></li>
		<li><a class="" href="/v4/general-information/parsing-obsidian-notes-to-proper-markdown.html"  >Parsing Obsidian notes to proper markdown</a></li>
		<li><a class="" href="/v4/general-information/report-issues-request-features.html"  >Report Issues & Request features</a></li>
		<li><a class="" href="/v4/general-information/using-the-website.html"  >Using the website</a></li>
	</ul>
</div>
<button id="folder-15" class="dir-button" onclick="toggle_dir(this.id)">instructions</button>
<div id="folder-container-15" class="dir-container requires_js " path="/v4/instructions">
	<button id="folder-16" class="dir-button" onclick="toggle_dir(this.id)">tutorials</button>
	<div id="folder-container-16" class="dir-container requires_js " path="/v4/instructions/tutorials">
		<button id="folder-17" class="dir-button" onclick="toggle_dir(this.id)">specifics</button>
		<div id="folder-container-17" class="dir-container requires_js " path="/v4/instructions/tutorials/specifics">
			<ul class="dir-list">
				<li><a class="" href="/v4/instructions/tutorials/specifics/bootstrapping-python-on-windows.html"  >Bootstrapping Python on Windows</a></li>
			</ul>
		</div>
		<ul class="dir-list">
			<li><a class="" href="/v4/instructions/tutorials/converting-just-one-subfolder-in-your-vault.html"  >Converting just one subfolder in your vault</a></li>
			<li><a class="" href="/v4/instructions/tutorials/tutorial-installation-on-windows.html"  >Tutorial - Installation on Windows</a></li>
		</ul>
	</div>
	<ul class="dir-list">
		<li><a class="" href="/v4/instructions/inspect-default-config.html"  >Inspect default config</a></li>
		<li><a class="" href="/v4/instructions/install-a-different-version.html"  >Install a different version</a></li>
		<li><a class="" href="/v4/instructions/installation.html"  >Installation</a></li>
		<li><a class="" href="/v4/instructions/obsidianhtml-run.html"  >Obsidianhtml Run</a></li>
		<li><a class="" href="/v4/instructions/quickstart.html"  >Quickstart</a></li>
		<li><a class="" href="/v4/instructions/run-custom-code.html"  >Run custom code</a></li>
		<li><a class="" href="/v4/instructions/usage.html"  >Usage</a></li>
	</ul>
</div>
<button id="folder-18" class="dir-button" onclick="toggle_dir(this.id)">log</button>
<div id="folder-container-18" class="dir-container requires_js " path="/v4/log">
	<ul class="dir-list">
		<li><a class="" href="/v4/log/moving-to-a-module-system.html"  >Moving to a Module system</a></li>
		<li><a class="" href="/v4/log/published-obsidianhtml-version-0.0.9-.html"  >Published ObsidianHtml version 0.0.9!</a></li>
		<li><a class="" href="/v4/log/published-obsidianhtml-version-1.0.0-.html"  >Published ObsidianHtml version 1.0.0!</a></li>
		<li><a class="" href="/v4/log/working-on-an-rss-feed-for-obsidianhtml.html"  >Working on an RSS feed for ObsidianHtml</a></li>
	</ul>
</div>
<ul class="dir-list">
	<li><a class="" href="/v4/index.html"  >Home</a></li>
	<li><a class="" href="/v4/news.html"  >News</a></li>
</ul>
</div>
    </div>
</div>
                        <div class="container">
                                
                <div style="width:100%; text-align: right;display: block;margin: 0.5rem;">
                    <div style="flex:1;display: none;"></div>
                    <div class="breadcrumbs" style="flex:1 ;padding: 0.5rem; width: fit-content;display: inline;border-radius: 0.2rem;">
                        <a href="/v4/" style="color: rgb(var(--normal-text-color));">Home</a> / <span style="color: #666;">configurations</span> / <span style="color: #666;">extending-obsidianhtml</span> / <a href="/v4/configurations/extending-obsidianhtml/module-documentation.html" >module-documentation</a>
                    </div>
                </div>
<embeddedtitle>Module Documentation</embeddedtitle>
<div class="content"><div class="callout callout-warning active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
</div>
<div class="callout-title-name">Warning
</div>
</div>
<div class="callout-content">
<p>The module system currently is still in <strong>alpha</strong>. Any part of the system might still change until further notice, so keep that in mind before diving into the module system.</p>
</div>
</div>
<h2 id="introduction">Introduction</h2>
<p>Modules are the proposed way <a href="/v4/log/moving-to-a-module-system.html">to keep the complexity of ever increasing amounts of features in check</a>. It is my intent to rewrite every chunk of functionality as a module, which will have a clearly defined function, interface, input and output, and thus will be able to be swapped out by a different module that provides the same output but that produces it in a different way.   </p>
<p>Built-in modules will also be required to include testing functions.   </p>
<h2 id="examples">Examples</h2>
<p>The module system is currently already in use (in the master branch code) for internal functions of ObsidianHtml.   </p>
<p>You can find all the modules, and the code to manage them, in this folder:   </p>
<ul>
<li><a href="https://github.com/obsidian-html/obsidian-html/tree/master/obsidianhtml/modules" class="external-link" class="external-link">https://github.com/obsidian-html/obsidian-html/tree/master/obsidianhtml/modules</a>   </li>
</ul>
<p>The builtin folder contains a number of modules that are currently used:   </p>
<ul>
<li><a href="https://github.com/obsidian-html/obsidian-html/tree/master/obsidianhtml/modules" class="external-link" class="external-link">https://github.com/obsidian-html/obsidian-html/tree/master/obsidianhtml/modules</a>/builtin   </li>
</ul>
<h1 id="high-level-design">High level design</h1>
<div class="toc">
<ul>
<li><a href="#introduction" class="anchor-link">Introduction</a></li>
<li><a href="#examples" class="anchor-link">Examples</a></li>
<li><a href="#high-level-design" class="anchor-link">High level design</a><ul>
<li><a href="#inputs-and-outputs" class="anchor-link">Inputs and outputs</a><ul>
<li><a href="#the-module_data-folder" class="anchor-link">The module_data folder</a></li>
</ul>
</li>
<li><a href="#module-interface" class="anchor-link">Module interface</a><ul>
<li><a href="#run-and-accept" class="anchor-link">Run() and Accept()</a></li>
<li><a href="#integration-functions" class="anchor-link">Integration functions</a></li>
</ul>
</li>
<li><a href="#module-config" class="anchor-link">Module config</a></li>
<li><a href="#instantiating-of-the-module" class="anchor-link">Instantiating of the module</a><ul>
<li><a href="#overwriting-the-abstract-base-class-s-__init__-method" class="anchor-link">Overwriting the abstract base class's __init__ method</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#module-structure" class="anchor-link">Module structure</a><ul>
<li><a href="#general" class="anchor-link">General</a></li>
<li><a href="#required-methods" class="anchor-link">Required methods</a></li>
<li><a href="#run" class="anchor-link">run()</a></li>
<li><a href="#accept-module_data_folder" class="anchor-link">accept(module_data_folder)</a></li>
<li><a href="#required-properties" class="anchor-link">Required properties</a><ul>
<li><a href="#requires" class="anchor-link">requires()</a></li>
<li><a href="#provides" class="anchor-link">provides()</a></li>
<li><a href="#alters" class="anchor-link">alters()</a></li>
</ul>
</li>
<li><a href="#the-requires-provides-alters-attributes" class="anchor-link">The requires, provides, alters attributes</a></li>
</ul>
</li>
<li><a href="#persistence" class="anchor-link">Persistence</a><ul>
<li><a href="#run-the-same-module-multiple-times" class="anchor-link">Run the same module multiple times</a></li>
</ul>
</li>
<li><a href="#metamodules" class="anchor-link">Metamodules</a></li>
<li><a href="#writing-modules-requirements" class="anchor-link">Writing modules &amp; requirements</a><ul>
<li><a href="#accessing-config-values" class="anchor-link">Accessing config values</a></li>
<li><a href="#reading-and-writing-modfiles" class="anchor-link">Reading and writing modfiles</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="inputs-and-outputs">Inputs and outputs</h2>
<p>All the inputs and outputs will be in the form of files. The default format should be pretty printed json, to be able to interoperate with different languages.   </p>
<p>One of the first modules to be written will take the given path to the user config, merge it with the default config, and write the merged config as a pretty printed json to either <code>md_output_folder/obs.html/module_data/config.json</code>  or <code>html_output_folder/obs.html/module_data/config.json</code>, depending on whether compile_html is true.   </p>
<h3 id="the-module_data-folder">The module_data folder</h3>
<p>At the beginning, one folder is chosen that will contain all the in- and output files.    </p>
<p><strong>All</strong> the in- and outputs will be written to that one folder. Subfolders are allowed, so one can choose to write to <code>html_output_folder/obs.html/module_data/md/...</code>  and <code>html_output_folder/obs.html/module_data/html/...</code> to discern similar outputs at different phases of the compilation.   </p>
<h2 id="module-interface">Module interface</h2>
<h3 id="run-and-accept">Run() and Accept()</h3>
<p>Very generally speaking, the module (denoted as <code>module</code>) provides the <code>module.run()</code> method, which does all the work. This method will read from the <code>module_data_folder</code>, write to it, and alter the temp_vault/md/html output.    </p>
<p>The <code>module.run()</code> method is normally called by <code>controller.run_module()</code>.    </p>
<p>Before the <code>module.run()</code> method is executed, another method, <code>module.accept()</code>, is executed first. If this returns <code>False</code>, further execution is stopped. Thus, via the accept method, you can tell ObsidianHtml whether the module should be run or not, based on user config, module data files, etc.   </p>
<p>Note that a <code>None</code> return value will also count as a "go ahead", this is to make it very explicitly that the module needs to return False to enact the module skipping behavior.   </p>
<div class="callout callout-important active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><path d="M8.5 14.5A2.5 2.5 0 0011 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 11-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 002.5 2.5z"></path></svg>
</div>
<div class="callout-title-name">Important
</div>
</div>
<div class="callout-content">
<p>The <code>module.integrate_load()</code> function (see below) is  always run, as this might provide necessary information to the module.accept() function.</p>
<p><strong>No post-modules are  run</strong> if <code>module.accept()</code> returns <code>False</code>! The module is skipped as if it was never called.</p>
</div>
</div>
<h3 id="integration-functions">Integration functions</h3>
<p>The module system is here to replace an older system, wherein all the necessary information is passed around in an object, aptly named PicknickBasket, or <code>pb</code> for short.   </p>
<p>As modules should disentangle data flow, this object is being phased out. To make it possible to write modules while other parts of the code are still using the <code>pb</code> object, you can use the <code>module.integrate_load()</code> method to read in data from the pb object prior to running your <code>module.run()</code> method, and <code>module.integrate_save()</code> to write any changes back into the <code>pb</code> object.   </p>
<div class="callout callout-important active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><path d="M8.5 14.5A2.5 2.5 0 0011 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 11-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 002.5 2.5z"></path></svg>
</div>
<div class="callout-title-name">Important
</div>
</div>
<div class="callout-content">
<p>Any data provided by a module should be written away as a file in the <code>module_data_folder</code>. Using data provided by other modules should also be done in this way! Once all the code is moved to a module structure, the <code>pb</code> object should be able to be removed. If you rely on this object existing when writing new modules, you are creating new dependencies on the <code>pb</code> object, which defeats the whole purpose.</p>
</div>
</div>
<p>When you write custom modules, you very likely don't need to integrate with the old (<code>pb</code>) system. So you can ignore these functions, as long as you implement them (to satisfy the requirements):   </p>
<div class="lang-python">

<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MyCustomModule</span><span class="p">(</span><span class="n">ObsidianHtmlModule</span><span class="p">):</span>
    <span class="c1"># &lt;provides, requires, alters blocks&gt; ...</span>
    <span class="c1"># &lt;run methods&gt; ...</span>
    <span class="k">def</span> <span class="nf">integrate_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pb</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">integrate_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pb</span><span class="p">):</span>
        <span class="k">pass</span>
</code></pre></div>


</div>

<p>The requirement here is pretty clear, you will get an error if you don't implement these.   </p>
<blockquote>
<p>Once the <code>pb</code> object is fully phased out, ObsidianHtml will start throwing deprecation warnings when these methods are defined, to prompt their timely removal, prior to full removal of the <code>pb</code> object (which would at that point break any code still trying to access the pb object).   </p>
</blockquote>
<h2 id="module-config">Module config</h2>
<p>We currently have config that is used by every part of the code. While we will keep global toggles, such as <code>verbosity</code>, it is also very nice to have a structured way to configure one separate module at a time.   </p>
<p>To add configuration to your module, define the <code>module.define_mod_config_defaults()</code> method. <br />
See the example below.   </p>
<div class="lang-python">

<div class="codehilite"><pre><span></span><code>    <span class="k">def</span> <span class="nf">define_mod_config_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mod_config</span><span class="p">[</span><span class="s2">&quot;fail_on_existing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Exit with error if output folders are not empty.&quot;</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mod_config</span><span class="p">[</span><span class="s2">&quot;clean_existing&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
            <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Files that exist in the output folders are deleted.&quot;</span>
        <span class="p">}</span>
</code></pre></div>


</div>

<p>Users can then pass in configuration via the config.yml via the <code>module_config</code> dict:   </p>
<div class="lang-yaml">

<div class="codehilite"><pre><span></span><code><span class="nt">module_config</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prepare_output_folders</span><span class="p">:</span>
<span class="w">    </span><span class="nt">fail_on_existing</span><span class="p">:</span><span class="w"> </span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Exit with error if output folders are not empty.</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="w">    </span><span class="nt">clean_existing</span><span class="p">:</span><span class="w"> </span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Files that exist in the output folders are deleted.</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
</code></pre></div>


</div>

<div class="callout callout-note active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><line x1="18" y1="2" x2="22" y2="6"></line><path d="M7.5 20.5L19 9l-4-4L3.5 16.5 2 22z"></path></svg>
</div>
<div class="callout-title-name">Note
</div>
</div>
<div class="callout-content">
<p>Currently, only the <code>value</code> value is copied from the config.yml into the <code>module.mod_config</code> object. <code>description</code> is mostly for documentation purposes. If you require more keys to be copied over, please <a href="/v4/general-information/report-issues-request-features.html">contact us</a> to get it added.</p>
</div>
</div>
<p>The key <code>prepare_output_folders</code> should match with the value for <code>name</code> as used in the module_list dict:   </p>
<div class="lang-yaml">

<div class="codehilite"><pre><span></span><code><span class="nt">module_list</span><span class="p">:</span>
<span class="w">  </span><span class="nt">preparation</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prepare_output_folders</span>
<span class="w">      </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ensures the output folders are created</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Optionally removes previous output if it exists in the target directories</span>
</code></pre></div>


</div>

<div class="callout callout-usage active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><line x1="18" y1="2" x2="22" y2="6"></line><path d="M7.5 20.5L19 9l-4-4L3.5 16.5 2 22z"></path></svg>
</div>
<div class="callout-title-name">Usage
</div>
</div>
<div class="callout-content">
<p>You can use <code>self.value_of("key")</code> to get the value of a module_configuration instead the considerably more annoying-to-type: <code>self.mod_config["key"]["value"]</code>.</p>
</div>
</div>
<h2 id="instantiating-of-the-module">Instantiating of the module</h2>
<p>The module will be instantiated by ObsidianHtml with the following input:   </p>
<ul>
<li>The parameter <code>module_data_folder</code> will be passed in, which is the absolute path in the form of a posix string pointing to the folder that was chosen to hold all the in- and outputs for the various modules.   </li>
<li><code>module_name</code> will be passed in. This is the name that you give in the <code>modules</code> list (see below), and can be considered a dog-tag, or alias. Not be confused with <code>ObsidianHtmlModule.module_class_name</code>, which will also be set, and which is the module class's name as defined in the python code (alias for <code>self.__class__.__name__</code>).   </li>
<li><code>persistent</code> (bool) will be passed in, denoting on whether the module object will be stored for later retrieval, or be a one-use instance.   </li>
</ul>
<p>All other input should be read from the module data folder.   </p>
<h3 id="overwriting-the-abstract-base-class-s-__init__-method">Overwriting the abstract base class's <code>__init__</code> method</h3>
<p>You shouldn't, really. Though perhaps there is some very special reason that you need to alter the init method.    </p>
<p>When overwriting this method, be sure to follow the same input scheme, and to call the ABC's init function:   </p>
<div class="lang-python">

<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># my custom code</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">my_custom_attr</span> <span class="o">=</span> <span class="s1">&#39;placeholder&#39;</span>

    <span class="c1"># invoke parent&#39;s init method </span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>


</div>

<h1 id="module-structure">Module structure</h1>
<h2 id="general">General</h2>
<p>A module is any class that extends the <code>obsidianhtml.modules.ObsidianHtmlModule</code> abstract base class, e.g.:   </p>
<div class="lang-python">

<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">obsidianhtml.modules</span> <span class="kn">import</span> <span class="n">ObsidianHtmlModule</span>
<span class="k">class</span> <span class="nc">MyModule</span><span class="p">(</span><span class="n">ObsidianHtmlModule</span><span class="p">):</span>
    <span class="k">pass</span>
</code></pre></div>


</div>

<p>Note that there are a couple of required methods that should be added to your class, for it to be accepted, see the section below.   </p>
<h2 id="required-methods">Required methods</h2>
<h2 id="run">run()</h2>
<p>The module is expected to implement at the very least the <code>run()</code> method. This method is supposed to execute the main module code.   </p>
<p>The method is supposed to return nothing. If it does, this is considered a failure. Currently this will just be logged and the program will continue. The provided resources will be marked as failed, thus blocking any modules reliant on it downstream.   </p>
<h2 id="accept-module_data_folder">accept(module_data_folder)</h2>
<p>Should return <code>False</code> if <code>module.run()</code> should not be executed, for any reason. Any other return value is taken as a go-ahead for running <code>module.run()</code>.   </p>
<h2 id="required-properties">Required properties</h2>
<p>Properties that are required are always implemented as <code>@property</code> annotated methods.   </p>
<h3 id="requires">requires()</h3>
<p>Should return a tuple of relative paths (posix strings) of the files that are expected to exist before the module is executed.   </p>
<p>Empty tuples are returned when no input is required.   </p>
<h3 id="provides">provides()</h3>
<p>Should return a tuple of relative paths (posix strings) of the files that are expected to exist before the module is executed.   </p>
<p>Empty tuples are returned when no output is written.   </p>
<h3 id="alters">alters()</h3>
<p>Should return a tuple of strings that denote what resources are altered by the module. Valid values are listed as:   </p>
<ul>
<li><code>"md_output_notes"</code>   <ul>
<li>The module writes in the markdown output folder, altering the content of the notes.   </li>
<li>If the module writes in the md folder, but does not touch the notes themselves, then use <code>"md_misc"</code>   </li>
</ul>
</li>
<li><code>"html_output_notes"</code>   <ul>
<li>The module writes in the html output folder, altering the content of the notes.   </li>
<li>If the module writes in the html folder, but does not touch the notes themselves, then use <code>"html_misc"</code>   </li>
</ul>
</li>
<li><code>"vault_notes"</code>   <ul>
<li>The module writes in the Obsidian vault.   </li>
<li>Modules with this setting are disallowed unless <code>copy_vault_to_tempdir: True</code>   <ul>
<li>This disallow can be overwritten by adding <code>toggles/unsafe: True</code> to the config.yaml   </li>
</ul>
</li>
<li>If the module writes in the vault, but does not touch the notes themselves, then use <code>"vault_misc"</code>   </li>
</ul>
</li>
</ul>
<p>Note that you don't need to specify whether the module writes in the module data folder, as this is apparent from the <code>ObsidianHtmlModule.provides</code> value.   </p>
<h2 id="the-requires-provides-alters-attributes">The requires, provides, alters attributes</h2>
<p>Optionally, the module can list the inputs it expects in the <code>ObsidianHtmlModule.requires</code> tuple object, and list the outputs it provides in the <code>ObsidianHtmlModule.provides</code> tuple object.   </p>
<p>If a module alters an existing file, you can list the file in both the <code>ObsidianHtmlModule.requires</code> and the <code>ObsidianHtmlModule.provides</code>. In fact, whenever a module is called that has an output with the same name as an existing output, the action will be logged as an <code>alter</code> action. E.g.:   </p>
<div class="lang-general">

<div class="codehilite"><pre><span></span><code><span class="n">ModuleA</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="o">[</span><span class="n">config</span><span class="p">.</span><span class="n">json</span><span class="o">]</span>
<span class="n">ModuleB</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">config</span><span class="p">.</span><span class="n">json</span><span class="err">;</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="o">[</span><span class="n">tags</span><span class="p">.</span><span class="n">json</span><span class="p">,</span><span class="w"> </span><span class="n">nodes</span><span class="p">.</span><span class="n">json</span><span class="o">]</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">altered</span><span class="w"> </span><span class="o">[</span><span class="n">config</span><span class="p">.</span><span class="n">json</span><span class="o">]</span>
</code></pre></div>


</div>

<p>Such a log will surely prove invaluable for following all the cross-interactions between modules and their input/outputs.   </p>
<h1 id="persistence">Persistence</h1>
<h2 id="run-the-same-module-multiple-times">Run the same module multiple times</h2>
<p>For every item in the <code>module</code> list, a new object will be created, even when the same module is listed multiple times. So the object of the first run is not the same as the object of the second run. This means that you cannot persist state within the object between runs (unless persistence is explicitly set).   </p>
<p>To reuse a module object it has to have <code>persistent: True</code> on the first call, and on the second call. <br />
Take this example:   </p>
<div class="lang-python">

<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">obsidianhtml.modules</span> <span class="kn">import</span> <span class="n">ObsidianHtmlModule</span>
<span class="k">class</span> <span class="nc">MyModule</span><span class="p">(</span><span class="n">ObsidianHtmlModule</span><span class="p">):</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">requires</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">()</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">provides</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">()</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hi_there</span> <span class="o">=</span> <span class="s2">&quot;hi from the second run&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;hi from the first run&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">run2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hi_there</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">export_module</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">MyModule</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>


</div>

<p>With    </p>
<div class="lang-yaml">

<div class="codehilite"><pre><span></span><code><span class="nt">modules</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custom</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;/path/to/module/file.py&#39;</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_module</span>
<span class="w">    </span><span class="nt">persistent</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">custom</span>
<span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;/path/to/module/file.py&#39;</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_module</span>
<span class="w">    </span><span class="nt">method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">run2</span>
<span class="w">    </span><span class="nt">persistent</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
</code></pre></div>


</div>

<p>Should give:   </p>
<div class="lang-general">

<div class="codehilite"><pre><span></span><code>hi from the first run
hi from the second run
</code></pre></div>


</div>

<p>If you don't set <code>persistent: True</code> on the first invocation, the module will not be stored, and thus not retrievable in the second run. If you don't set it at the second run, the module system will create a new module object, as that is the default behavior.   </p>
<h1 id="metamodules">Metamodules</h1>
<p>These modules apply to the running of other modules. They do not apply to themselves or other metamodules.   </p>
<p>They can be either run before running a module, think of a checker module; or after a module, for example a logger. For metamodules that should be run before every module, use <code>ObsidianHtmlPreModule</code>, and use <code>ObsidianHtmlPostModule</code> for the other case.   </p>
<p>Metamodules currently work similar to normal modules, except for:   </p>
<ul>
<li><code>ObsidianHtmlPostModule</code> will get the following extra inputs to their run method:   <ul>
<li><code>module</code>: the module object that was just run   </li>
<li><code>result</code>: the value that was returned by the module object's run method   </li>
</ul>
</li>
</ul>
<p>To be implemented:   </p>
<div class="lang-general">

<div class="codehilite"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`ObsidianHtmlPreModule`</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">following</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">inputs</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">method</span><span class="o">:</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n n-Quoted">`module`</span><span class="o">:</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">run</span>
</code></pre></div>


</div>

<h1 id="writing-modules-requirements">Writing modules &amp; requirements</h1>
<h2 id="accessing-config-values">Accessing config values</h2>
<p>You can use <code>self.gc()</code> "get config" method to load a key from the config yaml:   </p>
<div class="lang-python">

<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MyCustomModule</span><span class="p">(</span><span class="n">ObsidianHtmlModule</span><span class="p">):</span>
    <span class="c1"># &lt;provides, requires, alters blocks&gt; ...</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gc</span><span class="p">(</span><span class="s2">&quot;toggles/compile_md&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;do stuff&quot;</span><span class="p">)</span>
</code></pre></div>


</div>

<p>Notice here the slashes, which are used to navigate the config tree elements, e.g.:   </p>
<div class="lang-yaml">

<div class="codehilite"><pre><span></span><code><span class="nt">toggles</span><span class="p">:</span>
<span class="w">  </span><span class="nt">compile_md</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>


</div>

<h2 id="reading-and-writing-modfiles">Reading and writing modfiles</h2>
<p>Any file written into the <code>module_data_folder</code> is called a <code>modfile</code>. To read such a file from within your own module, see the following examples:   </p>
<div class="lang-python">

<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">MyCustomModule</span><span class="p">(</span><span class="n">ObsidianHtmlModule</span><span class="p">):</span>

    <span class="c1"># &lt;provides, requires, alters blocks&gt; ...</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># write simple file to module_data_folder/test.md</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modfile</span><span class="p">(</span><span class="s2">&quot;test.md&quot;</span><span class="p">,</span> <span class="s2">&quot;hi there&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>

        <span class="c1"># convert to json</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modfile</span><span class="p">(</span><span class="s2">&quot;test.json&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;this is&#39;</span><span class="p">,</span> <span class="s1">&#39;a list&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">run2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># retrieve contents with .text()</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modfile</span><span class="p">(</span><span class="s2">&quot;test.md&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>

        <span class="c1"># convert contents and retrieve them with .from_json() and .from_yaml()</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modfile</span><span class="p">(</span><span class="s2">&quot;test.json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">from_json</span><span class="p">()</span>
</code></pre></div>


</div>

<p>The object returned by <code>self.modfile()</code> will do checking upon accessing the modfiles. If a modfile is read but not listed under <code>self.requires</code>, then this will lead to an error, and similarly for writing a file.   </p>
<div class="callout callout-attention active" rasa="1">
<div class="callout-title ">
<div class="callout-title-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="callout-icon"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
</div>
<div class="callout-title-name">Attention
</div>
</div>
<div class="callout-content">
<p>Any modules that are added in PR's that read/write modfiles with other means than <code>self.modfile().*.write()</code> and <code>self.modfile().read()</code> will be rejected.</p>
</div>
</div></div>
<div class="note-footer">
<div class="backlinks">
<h2>Backlinks</h2>
<ul>
	<li><a class="backlink" href="/v4/log/moving-to-a-module-system.html">moving to a module system</a></li>
</ul>
</div>

<div class="tags">

</div>

</div>
<div class="graph requires_js ">
    <div id="A338804270576531905282494747288532456792{level}" class="graph_div"></div>
    
    <div class="graph-button-row" style="display:flex;">
        <button class="graph_button graph_show_button" id="B338804270576531905282494747288532456792{level}" level="{level}" note_temp_id="338804270576531905282494747288532456792" onclick="window.ObsHtmlGraph.run(this, '338804270576531905282494747288532456792', 'module documentation');">
            Show Graph
        </button>
        <button class="graph_button graph_type_button" id="C338804270576531905282494747288532456792{level}" style="flex:1" onclick="window.ObsHtmlGraph.switch_graph_type(this);">
            2D
        </button>
    </div>
</div>

<script type="module">
    if (window.ObsHtmlGraph == undefined){
        import('/v4/obs.html/static/graph.js').then((Module) => {
            window.ObsHtmlGraph = Module;
            window.ObsHtmlGraph.arm_page(document.getElementById('page_holder'))
        })
    }
</script>




                                <!-- end content -->
                        </div>
                        <div class="container_filler">
                        </div>
                        <div id="right_pane" class="right_pane active">
    <div id="right_pane_fold_header" class="right_pane_fold_header fold_header">x</div>
    <div id="right_pane_content" class="right_pane_content">
            
    </div>
</div>
                </div>
        </div>

        <script>
                function handle_toggle_side_bar(e){
                        let header;
                        let pane; 
                        let target = e.target

                        // switch out the navbar button click for a header click
                        if (target.id == 'left_pane_toggle_nav'){
                                target = document.getElementById('left_pane_fold_header')
                        }
                        else if (target.id == 'right_pane_toggle_nav'){
                                target = document.getElementById('right_pane_fold_header')
                        }

                        // get header and pane
                        if (target.classList.contains('fold_header')) {
                                header = target;
                                pane = target.parentElement;
                        }
                        else {
                                pane = target;
                                header = target.getElementsByClassName('fold_header')[0];
                        }
                        toggle_side_bar(pane, header, true)
                        e.stopPropagation();
                }
                function handle_toggle_side_bar_button(e){
                        document.getElementById('menu_toggle_button').click()
                        handle_toggle_side_bar(e);
                }

                function toggle_side_bar(pane, header, save) {
                        let active = (pane.classList.contains('active'))
                        if (active){
                                disable_side_bar(pane, header, save);
                        }
                        else {
                                enable_side_bar(pane, header, save);
                        }
                }
                function enable_side_bar(pane, header, save){
                        pane.classList.add('active');
                        pane.removeEventListener('click', handle_toggle_side_bar);
                        header.addEventListener('click', handle_toggle_side_bar);
                        set_correct_header_symbol(header);
                        if (save){ save_panel_folding_state(header, true) }
                }
                function disable_side_bar(pane, header, save){
                        pane.classList.remove('active');
                        pane.addEventListener('click', handle_toggle_side_bar);
                        header.removeEventListener('click', handle_toggle_side_bar);
                        set_correct_header_symbol(header);
                        if (save){ save_panel_folding_state(header, false) }
                }
                function set_correct_header_symbol(header){
                        let pane = header.parentElement;
                        let symbol = [['>', '<'],['<', '>']]
                        symbol = symbol[Number(header.classList.contains('right_pane_fold_header'))][Number(pane.classList.contains('active'))];
                        console.log(symbol);
                        header.innerHTML = symbol
                        return header;
                }
                function panel_folding_get_panel_name(header){
                        return ['left', 'right'][Number(header.classList.contains('right_pane_fold_header'))]
                }
                function save_panel_folding_state(header, active){
                        ls_set('pane_folding_state_'+panel_folding_get_panel_name(header), Number(active));
                }
                function load_panel_folding_state(panel_name){
                        val = ls_get('pane_folding_state_'+panel_name)
                        if (!val){ return {'exists': false, 'value': null}}
                        return {'exists': true, 'value': Boolean(Number(val))}
                }
                function set_pane_folding_start(left_header, right_header){
                        // small screen = closed
                        let right_pane_enabled = true;
                        let left_pane_enabled = true;
                        let w = window.visualViewport.width
                        if (w < 1000){
                                left_pane_enabled = false
                        }
                        if (w < 800){
                                right_pane_enabled = false
                        }

                        // get saved values if present
                        let rval = load_panel_folding_state('right')
                        if (rval['exists']){
                                right_pane_enabled = rval['value']
                        }
                        let lval = load_panel_folding_state('left')
                        if (lval['exists']){
                                left_pane_enabled = lval['value']
                        }

                        // default = enabled, so we only need to disable
                        if (!left_pane_enabled){
                                disable_side_bar(document.getElementById('left_pane'), document.getElementById('left_pane_fold_header'))
                        }
                        if (!right_pane_enabled){
                                disable_side_bar(document.getElementById('right_pane'), document.getElementById('right_pane_fold_header'))
                        }
                }

                function init_pane_folding(header){
                        set_correct_header_symbol(header);
                        header.addEventListener('click', handle_toggle_side_bar);
                }
                
                
                set_pane_folding_start()
                init_pane_folding(document.getElementById('left_pane_fold_header'));
                init_pane_folding(document.getElementById('right_pane_fold_header'));

                document.getElementById('left_pane_toggle_nav').addEventListener('click', handle_toggle_side_bar_button);
                document.getElementById('right_pane_toggle_nav').addEventListener('click', handle_toggle_side_bar_button);
        </script>

        <script src="/v4/obs.html/static/load_dirtree_footer.js" type="text/javascript"></script>

        




</body>
</html>
